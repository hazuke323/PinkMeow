{"version":3,"sources":["file:///Users/huwenting/Documents/Web3Pink/PinkMCat/assets/src/Tools/List.ts"],"names":["Node","Component","Enum","tween","_decorator","EventHandler","ScrollView","Prefab","Layout","Vec2","Size","NodePool","isValid","instantiate","Vec3","Widget","UITransform","CCFloat","CCBoolean","CCInteger","EventTouch","SystemEventType","ViewGroup","DEV","ListItem","ccclass","property","disallowMultiple","menu","executionOrder","requireComponent","TemplateType","SlideType","SelectedType","_tempVec2","_tempVec2_1","List","type","tooltip","visible","templateType","NODE","PREFAB","range","slide","_slideMode","PAGE","val","slideMode","NORMAL","cyclic","virtual","lackCenter","lackSlide","selectedMode","NONE","SINGLE","serializable","_selectedId","_lastSelectedId","multSelected","_forceUpdate","_align","_horizontalDir","_verticalDir","_startAxis","_alignCalcType","content","_contentUt","firstListId","displayItemNum","_updateDone","_updateCounter","_actualNumItems","_cyclicNum","_cyclicPos1","_cyclicPos2","_inited","_scrollView","_layout","_resizeMode","_topGap","_rightGap","_bottomGap","_leftGap","_columnGap","_lineGap","_colLineNum","_lastDisplayData","displayData","_pool","_itemTmp","_itemTmpUt","_needUpdateWidget","_itemSize","_sizeType","_customSize","frameCount","_aniDelRuning","_aniDelCB","_aniDelItem","_aniDelBeforePos","_aniDelBeforeScale","viewTop","viewRight","viewBottom","viewLeft","_doneAfterUpdate","elasticTop","elasticRight","elasticBottom","elasticLeft","scrollToListId","adhering","_adheringBarrier","nearestListId","curPageNum","_beganPos","_scrollPos","_curScrollIsTouch","_scrollToListId","_scrollToEndTime","_scrollToSo","_lack","_allItemSize","_allItemSizeNoEdge","_scrollItem","_thisNodeUt","_virtual","_numItems","_onScrolling","updateRate","_updateRate","selectedId","t","item","repeatEventSingle","getItemByListId","listItem","getComponent","selected","lastItem","selectedEvent","emitEvents","MULT","bool","sub","indexOf","push","splice","numItems","checkInited","console","error","_resizeContent","frameByFrameRenderNum","layout","enabled","_delRedundantItem","len","n","_createOrUpdateItem2","scrollView","contentChild","children","onLoad","_init","onDestroy","destroy","tmpNode","clear","onEnable","_registerEvent","position","scale","onDisable","_unregisterEvent","node","on","EventType","TOUCH_START","_onTouchStart","_onTouchUp","TOUCH_CANCEL","_onTouchCancelled","_onScrollBegan","_onScrollEnded","SIZE_CHANGED","_onSizeChanged","off","name","resizeMode","startAxis","paddingTop","paddingRight","paddingBottom","paddingLeft","spacingX","spacingY","verticalDirection","horizontalDirection","setTemplateItem","tmpPrefab","ADHERING","inertia","_onMouseWheel","_onTouchMoved","event","captureListeners","enabledInHierarchy","_content","touch","deltaMove","getUIDelta","y","_handleMoveLogic","cancelInnerEvents","getUILocation","subtract","getUIStartLocation","length","_touchMoved","target","cancelEvent","getTouches","bubbles","simulate","dispatchEvent","_stopPropagationIfTargetIsMe","_hasNestedViewGroup","eventPhase","Event","CAPTURING_PHASE","listener","x","propagationStopped","_onTouchEnded","_dispatchEvent","TOUCH_UP","_handleReleaseLogic","_processAutoScrolling","bind","_startBounceBackIfNeeded","Type","HORIZONTAL","HorizontalDirection","LEFT_TO_RIGHT","RIGHT_TO_LEFT","VERTICAL","VerticalDirection","TOP_TO_BOTTOM","BOTTOM_TO_TOP","GRID","AxisDirection","removeAllChildren","dt","OUT_OF_BOUNDARY_BREAKING_FACTOR","EPSILON","ZERO","quintEaseOut","time","sv","isAutoScrollBrake","brakingFactor","percentage","Math","min","clonedAutoScrollTargetDelta","clone","multiplyScalar","clonedAutoScrollStartPosition","add","reachedEnd","abs","fireEvent","SCROLL_ENG_WITH_THRESHOLD","brakeOffsetPosition","set","moveDelta","outOfBoundary","equals","SCROLLING","SCROLL_ENDED","ResizeMode","CHILDREN","cellSize","itemUt","width","height","com","remove","trimW","floor","trimH","printLog","result","fixed","_getFixedSize","count","lineNum","ceil","colNum","totalSize","spacing","_cyclicAllItemSize","_cycilcAllItemSizeNoEdge","slideOffset","targetWH","ev","scrollPos","getPosition","addVal","contentPos","z","setPosition","isAutoScrolling","_calcViewPos","vTop","vRight","vBottom","vLeft","itemPos","curId","endId","breakFor","_calcItemPos","right","left","bottom","top","ww","hh","id","haveDataChange","sort","a","b","c","_createOrUpdateItem","_calcNearestItem","itemX","itemY","cs","offset","anchorX","anchorY","colLine","_calcExistItemPos","ut","pos","data","getItemPos","listId","parseInt","to","start","adhere","_pageAdhere","isMe","AT_TARGET","itemNode","_listId","parent","_onItemAdaptive","updateAll","unschedule","scrollTo","max","Date","getTime","curPos","dis","pageDistance","canSkip","timeInSecond","prePage","nextPage","update","canGet","size","get","setContentSize","_resetItemSize","addChild","widget","updateAlignment","setSiblingIndex","list","renderEvent","_updateListItem","_updateItemPos","listIdOrItem","isNaN","setMultSelected","args","Array","isArray","getMultSelected","hasMultSelected","updateItem","_getOutsideItem","find","d","arr","isCached","put","m","_delSingleItem","removeFromParent","aniDelItem","callFunc","aniType","warn","curLastId","resetSelectedId","showAni","newId","newData","newCustomSize","idNumber","sec","twe","haveCB","posData","call","overStress","updateLayout","targetX","targetY","viewPos","comparePos","runScroll","scrollToOffset","scheduleOnce","center","skipPage","pageNum","pageChangeEvent","calcCustomSize","temp","Object","keys"],"mappings":"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","sourcesContent":["/******************************************\r\n * @author kL <klk0@qq.com>\r\n * @date 2020/12/9\r\n * @doc 列表组件.\r\n * @end\r\n ******************************************/\r\nconst { ccclass, property, disallowMultiple, menu, executionOrder, requireComponent } = _decorator;\r\nimport { Node, Component, Enum, tween, _decorator, EventHandler, Tween, ScrollView, Prefab, Layout, Vec2, Size, NodePool, isValid, instantiate, Vec3, Widget, UITransform, CCFloat, CCBoolean, CCInteger, EventTouch, SystemEventType, ViewGroup } from 'cc';\r\nimport { DEV } from 'cc/env';\r\nimport ListItem from './ListItem';\r\n\r\nenum TemplateType {\r\n    NODE = 1,\r\n    PREFAB = 2,\r\n}\r\n\r\nenum SlideType {\r\n    NORMAL = 1,//普通\r\n    ADHERING = 2,//粘附模式，将强制关闭滚动惯性\r\n    PAGE = 3,//页面模式，将强制关闭滚动惯性\r\n}\r\n\r\nenum SelectedType {\r\n    NONE = 0,\r\n    SINGLE = 1,//单选\r\n    MULT = 2,//多选\r\n}\r\n\r\nconst _tempVec2 = new Vec2();\r\nconst _tempVec2_1 = new Vec2();\r\n\r\n@ccclass\r\n@disallowMultiple()\r\n@menu('List')\r\n@requireComponent(ScrollView)\r\n//脚本生命周期回调的执行优先级。小于 0 的脚本将优先执行，大于 0 的脚本将最后执行。该优先级只对 onLoad, onEnable, start, update 和 lateUpdate 有效，对 onDisable 和 onDestroy 无效。\r\n@executionOrder(-5000)\r\nexport default class List extends Component {\r\n    //模板类型\r\n    @property({ type: Enum(TemplateType), tooltip: DEV && '模板类型', })\r\n    private templateType: TemplateType = TemplateType.NODE;\r\n    //模板Item（Node）\r\n    @property({\r\n        type: Node,\r\n        tooltip: DEV && '模板Item',\r\n        visible() { return this.templateType == TemplateType.NODE; }\r\n    })\r\n    tmpNode: Node = null;\r\n    //模板Item（Prefab）\r\n    @property({\r\n        type: Prefab,\r\n        tooltip: DEV && '模板Item',\r\n        visible() { return this.templateType == TemplateType.PREFAB; }\r\n    })\r\n    tmpPrefab: Prefab = null;\r\n    //滑动模式\r\n    @property({})\r\n    private _slideMode: SlideType = SlideType.NORMAL;\r\n    @property({\r\n        type: Enum(SlideType),\r\n        tooltip: DEV && '滑动模式'\r\n    })\r\n    set slideMode(val: SlideType) {\r\n        this._slideMode = val;\r\n    }\r\n    get slideMode() {\r\n        return this._slideMode;\r\n    }\r\n    //翻页作用距离\r\n    @property({\r\n        type: CCFloat,\r\n        range: [0, 1, .1],\r\n        tooltip: DEV && '翻页作用距离',\r\n        slide: true,\r\n        visible() { return this._slideMode == SlideType.PAGE; }\r\n    })\r\n    public pageDistance: number = .3;\r\n    //页面改变事件\r\n    @property({\r\n        type: EventHandler,\r\n        tooltip: DEV && '页面改变事件',\r\n        visible() { return this._slideMode == SlideType.PAGE; }\r\n    })\r\n    private pageChangeEvent: EventHandler = new EventHandler();\r\n    //是否为虚拟列表（动态列表）\r\n    @property({})\r\n    private _virtual: boolean = true;\r\n    @property({\r\n        type: CCBoolean,\r\n        tooltip: DEV && '是否为虚拟列表（动态列表）'\r\n    })\r\n    set virtual(val: boolean) {\r\n        if (val != null)\r\n            this._virtual = val;\r\n        if (!DEV && this._numItems != 0) {\r\n            this._onScrolling();\r\n        }\r\n    }\r\n    get virtual() {\r\n        return this._virtual;\r\n    }\r\n    //是否为循环列表\r\n    @property({\r\n        tooltip: DEV && '是否为循环列表',\r\n        visible() {\r\n            let val: boolean = /*this.virtual &&*/ this.slideMode == SlideType.NORMAL;\r\n            if (!val)\r\n                this.cyclic = false;\r\n            return val;\r\n        }\r\n    })\r\n    public cyclic: boolean = false;\r\n    //缺省居中\r\n    @property({\r\n        tooltip: DEV && 'Item数量不足以填满Content时，是否居中显示Item（不支持Grid布局）',\r\n        visible() { return this.virtual; }\r\n    })\r\n    public lackCenter: boolean = false;\r\n    //缺省可滑动\r\n    @property({\r\n        tooltip: DEV && 'Item数量不足以填满Content时，是否可滑动',\r\n        visible() {\r\n            let val: boolean = this.virtual && !this.lackCenter;\r\n            if (!val)\r\n                this.lackSlide = false;\r\n            return val;\r\n        }\r\n    })\r\n    public lackSlide: boolean = false;\r\n    //刷新频率\r\n    @property({ type: CCInteger })\r\n    private _updateRate: number = 0;\r\n    @property({\r\n        type: CCInteger,\r\n        range: [0, 6, 1],\r\n        tooltip: DEV && '刷新频率（值越大刷新频率越低、性能越高）',\r\n        slide: true,\r\n    })\r\n    set updateRate(val: number) {\r\n        if (val >= 0 && val <= 6) {\r\n            this._updateRate = val;\r\n        }\r\n    }\r\n    get updateRate() {\r\n        return this._updateRate;\r\n    }\r\n    //分帧渲染（每帧渲染的Item数量（<=0时关闭分帧渲染））\r\n    @property({\r\n        type: CCInteger,\r\n        range: [0, 12, 1],\r\n        tooltip: DEV && '逐帧渲染时，每帧渲染的Item数量（<=0时关闭分帧渲染）',\r\n        slide: true,\r\n    })\r\n    public frameByFrameRenderNum: number = 0;\r\n    //渲染事件（渲染器）\r\n    @property({\r\n        type: EventHandler,\r\n        tooltip: DEV && '渲染事件（渲染器）',\r\n    })\r\n    public renderEvent: EventHandler = new EventHandler();\r\n    //选择模式\r\n    @property({\r\n        type: Enum(SelectedType),\r\n        tooltip: DEV && '选择模式'\r\n    })\r\n    public selectedMode: SelectedType = SelectedType.NONE;\r\n    //触发选择事件\r\n    @property({\r\n        type: EventHandler,\r\n        tooltip: DEV && '触发选择事件',\r\n        visible() { return this.selectedMode > SelectedType.NONE; }\r\n    })\r\n    public selectedEvent: EventHandler = new EventHandler();\r\n    @property({\r\n        tooltip: DEV && '是否重复响应单选事件',\r\n        visible() { return this.selectedMode == SelectedType.SINGLE; }\r\n    })\r\n    public repeatEventSingle: boolean = false;\r\n\r\n    //当前选择id\r\n    private _selectedId: number = -1;\r\n    private _lastSelectedId: number;\r\n    private multSelected: number[];\r\n    set selectedId(val: number) {\r\n        let t: any = this;\r\n        let item: any;\r\n        switch (t.selectedMode) {\r\n            case SelectedType.SINGLE: {\r\n                if (!t.repeatEventSingle && val == t._selectedId)\r\n                    return;\r\n                item = t.getItemByListId(val);\r\n                // if (!item && val >= 0)\r\n                //     return;\r\n                let listItem: ListItem;\r\n                if (t._selectedId >= 0)\r\n                    t._lastSelectedId = t._selectedId;\r\n                else //如果＜0则取消选择，把_lastSelectedId也置空吧，如果以后有特殊需求再改吧。\r\n                    t._lastSelectedId = null;\r\n                t._selectedId = val;\r\n                if (item) {\r\n                    listItem = item.getComponent(ListItem);\r\n                    listItem.selected = true;\r\n                }\r\n                if (t._lastSelectedId >= 0 && t._lastSelectedId != t._selectedId) {\r\n                    let lastItem: any = t.getItemByListId(t._lastSelectedId);\r\n                    if (lastItem) {\r\n                        lastItem.getComponent(ListItem).selected = false;\r\n                    }\r\n                }\r\n                if (t.selectedEvent) {\r\n                    EventHandler.emitEvents([t.selectedEvent], item, val % this._actualNumItems, t._lastSelectedId == null ? null : (t._lastSelectedId % this._actualNumItems));\r\n                }\r\n                break;\r\n            }\r\n            case SelectedType.MULT: {\r\n                item = t.getItemByListId(val);\r\n                if (!item)\r\n                    return;\r\n                let listItem = item.getComponent(ListItem);\r\n                if (t._selectedId >= 0)\r\n                    t._lastSelectedId = t._selectedId;\r\n                t._selectedId = val;\r\n                let bool: boolean = !listItem.selected;\r\n                listItem.selected = bool;\r\n                let sub: number = t.multSelected.indexOf(val);\r\n                if (bool && sub < 0) {\r\n                    t.multSelected.push(val);\r\n                } else if (!bool && sub >= 0) {\r\n                    t.multSelected.splice(sub, 1);\r\n                }\r\n                if (t.selectedEvent) {\r\n                    EventHandler.emitEvents([t.selectedEvent], item, val % this._actualNumItems, t._lastSelectedId == null ? null : (t._lastSelectedId % this._actualNumItems), bool);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    get selectedId() {\r\n        return this._selectedId;\r\n    }\r\n    private _forceUpdate: boolean = false;\r\n    private _align: number;\r\n    private _horizontalDir: number;\r\n    private _verticalDir: number;\r\n    private _startAxis: number;\r\n    private _alignCalcType: number;\r\n    public content: Node;\r\n    private _contentUt: UITransform;\r\n    private firstListId: number;\r\n    public displayItemNum: number;\r\n    private _updateDone: boolean = true;\r\n    private _updateCounter: number;\r\n    public _actualNumItems: number;\r\n    private _cyclicNum: number;\r\n    private _cyclicPos1: number;\r\n    private _cyclicPos2: number;\r\n    //列表数量\r\n    @property({\r\n        serializable: false\r\n    })\r\n    private _numItems: number = 0;\r\n    set numItems(val: number) {\r\n        let t = this;\r\n        if (!t.checkInited(false))\r\n            return;\r\n        if (val == null || val < 0) {\r\n            console.error('numItems set the wrong::', val);\r\n            return;\r\n        }\r\n        t._actualNumItems = t._numItems = val;\r\n        t._forceUpdate = true;\r\n\r\n        if (t._virtual) {\r\n            t._resizeContent();\r\n            if (t.cyclic) {\r\n                t._numItems = t._cyclicNum * t._numItems;\r\n            }\r\n            t._onScrolling();\r\n            if (!t.frameByFrameRenderNum && t.slideMode == SlideType.PAGE)\r\n                t.curPageNum = t.nearestListId;\r\n        } else {\r\n            if (t.cyclic) {\r\n                t._resizeContent();\r\n                t._numItems = t._cyclicNum * t._numItems;\r\n            }\r\n            let layout: Layout = t.content.getComponent(Layout);\r\n            if (layout) {\r\n                layout.enabled = true;\r\n            }\r\n            t._delRedundantItem();\r\n\r\n            t.firstListId = 0;\r\n            if (t.frameByFrameRenderNum > 0) {\r\n                //先渲染几个出来\r\n                let len: number = t.frameByFrameRenderNum > t._numItems ? t._numItems : t.frameByFrameRenderNum;\r\n                for (let n: number = 0; n < len; n++) {\r\n                    t._createOrUpdateItem2(n);\r\n                }\r\n                if (t.frameByFrameRenderNum < t._numItems) {\r\n                    t._updateCounter = t.frameByFrameRenderNum;\r\n                    t._updateDone = false;\r\n                }\r\n            } else {\r\n                for (let n: number = 0; n < t._numItems; n++) {\r\n                    t._createOrUpdateItem2(n);\r\n                }\r\n                t.displayItemNum = t._numItems;\r\n            }\r\n        }\r\n    }\r\n    get numItems() {\r\n        return this._actualNumItems;\r\n    }\r\n\r\n    private _inited: boolean = false;\r\n    private _scrollView: ScrollView;\r\n    get scrollView() {\r\n        return this._scrollView;\r\n    }\r\n    private _layout: Layout;\r\n    private _resizeMode: number;\r\n    private _topGap: number;\r\n    private _rightGap: number;\r\n    private _bottomGap: number;\r\n    private _leftGap: number;\r\n\r\n    private _columnGap: number;\r\n    private _lineGap: number;\r\n    private _colLineNum: number;\r\n\r\n    private _lastDisplayData: number[];\r\n    public displayData: any[];\r\n    private _pool: NodePool;\r\n\r\n    private _itemTmp: any;\r\n    private _itemTmpUt: UITransform;\r\n    private _needUpdateWidget: boolean = false;\r\n    private _itemSize: Size;\r\n    private _sizeType: boolean;\r\n\r\n    public _customSize: any;\r\n\r\n    private frameCount: number;\r\n    private _aniDelRuning: boolean = false;\r\n    private _aniDelCB: Function;\r\n    private _aniDelItem: any;\r\n    private _aniDelBeforePos: Vec2;\r\n    private _aniDelBeforeScale: number;\r\n    private viewTop: number;\r\n    private viewRight: number;\r\n    private viewBottom: number;\r\n    private viewLeft: number;\r\n\r\n    private _doneAfterUpdate: boolean = false;\r\n\r\n    private elasticTop: number;\r\n    private elasticRight: number;\r\n    private elasticBottom: number;\r\n    private elasticLeft: number;\r\n\r\n    private scrollToListId: number;\r\n\r\n    private adhering: boolean = false;\r\n\r\n    private _adheringBarrier: boolean = false;\r\n    private nearestListId: number;\r\n\r\n    public curPageNum: number = 0;\r\n    private _beganPos: number;\r\n    private _scrollPos: number;\r\n    private _curScrollIsTouch: boolean;//当前滑动是否为手动\r\n\r\n    private _scrollToListId: number;\r\n    private _scrollToEndTime: number;\r\n    private _scrollToSo: any;\r\n\r\n    private _lack: boolean;\r\n    private _allItemSize: number;\r\n    private _allItemSizeNoEdge: number;\r\n\r\n    private _scrollItem: any;//当前控制 ScrollView 滚动的 Item\r\n\r\n    private _thisNodeUt: UITransform;\r\n\r\n    get contentChild(){\r\n        return this.content.children;\r\n    }\r\n\r\n    //----------------------------------------------------------------------------\r\n\r\n    onLoad() {\r\n        this._init();\r\n    }\r\n\r\n    onDestroy() {\r\n        let t: any = this;\r\n        if (isValid(t._itemTmp))\r\n            t._itemTmp.destroy();\r\n        if (isValid(t.tmpNode))\r\n            t.tmpNode.destroy();\r\n        t._pool && t._pool.clear();\r\n    }\r\n\r\n    onEnable() {\r\n        // if (!EDITOR) \r\n        this._registerEvent();\r\n        this._init();\r\n        // 处理重新显示后，有可能上一次的动画移除还未播放完毕，导致动画卡住的问题\r\n        if (this._aniDelRuning) {\r\n            this._aniDelRuning = false;\r\n            if (this._aniDelItem) {\r\n                if (this._aniDelBeforePos) {\r\n                    this._aniDelItem.position = this._aniDelBeforePos;\r\n                    delete this._aniDelBeforePos;\r\n                }\r\n                if (this._aniDelBeforeScale) {\r\n                    this._aniDelItem.scale = this._aniDelBeforeScale;\r\n                    delete this._aniDelBeforeScale;\r\n                }\r\n                delete this._aniDelItem;\r\n            }\r\n            if (this._aniDelCB) {\r\n                this._aniDelCB();\r\n                delete this._aniDelCB;\r\n            }\r\n        }\r\n    }\r\n\r\n    onDisable() {\r\n        // if (!EDITOR) \r\n        this._unregisterEvent();\r\n    }\r\n    //注册事件\r\n    _registerEvent() {\r\n        let t: any = this;\r\n        t.node.on(Node.EventType.TOUCH_START, t._onTouchStart, t, true);\r\n        t.node.on('touch-up', t._onTouchUp, t);\r\n        t.node.on(Node.EventType.TOUCH_CANCEL, t._onTouchCancelled, t, true);\r\n        t.node.on('scroll-began', t._onScrollBegan, t);\r\n        t.node.on('scroll-ended', t._onScrollEnded, t);\r\n        t.node.on('scrolling', t._onScrolling, t);\r\n        t.node.on(Node.EventType.SIZE_CHANGED, t._onSizeChanged, t);\r\n    }\r\n    //卸载事件\r\n    _unregisterEvent() {\r\n        let t: any = this;\r\n        t.node.off(Node.EventType.TOUCH_START, t._onTouchStart, t, true);\r\n        t.node.off('touch-up', t._onTouchUp, t);\r\n        t.node.off(Node.EventType.TOUCH_CANCEL, t._onTouchCancelled, t, true);\r\n        t.node.off('scroll-began', t._onScrollBegan, t);\r\n        t.node.off('scroll-ended', t._onScrollEnded, t);\r\n        t.node.off('scrolling', t._onScrolling, t);\r\n        t.node.off(Node.EventType.SIZE_CHANGED, t._onSizeChanged, t);\r\n    }\r\n    //初始化各种..\r\n    _init() {\r\n        let t: any = this;\r\n        if (t._inited)\r\n            return;\r\n\r\n        t._thisNodeUt = t.node.getComponent(UITransform);\r\n        t._scrollView = t.node.getComponent(ScrollView);\r\n\r\n        t.content = t._scrollView.content;\r\n        t._contentUt = t.content.getComponent(UITransform);\r\n        if (!t.content) {\r\n            console.error(t.node.name + \"'s ScrollView unset content!\");\r\n            return;\r\n        }\r\n\r\n        t._layout = t.content.getComponent(Layout);\r\n\r\n        t._align = t._layout.type; //排列模式\r\n        t._resizeMode = t._layout.resizeMode; //自适应模式\r\n        t._startAxis = t._layout.startAxis;\r\n\r\n        t._topGap = t._layout.paddingTop; //顶边距\r\n        t._rightGap = t._layout.paddingRight; //右边距\r\n        t._bottomGap = t._layout.paddingBottom; //底边距\r\n        t._leftGap = t._layout.paddingLeft; //左边距\r\n\r\n        t._columnGap = t._layout.spacingX; //列距\r\n        t._lineGap = t._layout.spacingY; //行距\r\n\r\n        t._colLineNum; //列数或行数（非GRID模式则=1，表示单列或单行）;\r\n\r\n        t._verticalDir = t._layout.verticalDirection; //垂直排列子节点的方向\r\n        t._horizontalDir = t._layout.horizontalDirection; //水平排列子节点的方向\r\n\r\n        t.setTemplateItem(instantiate(t.templateType == TemplateType.PREFAB ? t.tmpPrefab : t.tmpNode));\r\n\r\n        // 特定的滑动模式处理\r\n        if (t._slideMode == SlideType.ADHERING || t._slideMode == SlideType.PAGE) {\r\n            t._scrollView.inertia = false;\r\n            t._scrollView._onMouseWheel = function () {\r\n                return;\r\n            };\r\n        }\r\n\r\n        if(!t._sizeType) {\r\n            t._scrollView._onTouchMoved = function (event: EventTouch, captureListeners?: Node[]) {\r\n                if (!this.enabledInHierarchy || !this._content) { return; }\r\n                       \r\n                const touch = event.touch!;\r\n                let deltaMove = touch.getUIDelta();\r\n                // console.log(deltaMove.x,deltaMove.y,t.node.parent.name);\r\n                if(deltaMove.y > 7 || deltaMove.y < -7){\r\n                    return;\r\n                }\r\n\r\n                this._handleMoveLogic(touch);\r\n        \r\n                // Do not prevent touch events in inner nodes\r\n                if (!this.cancelInnerEvents) {\r\n                    return;\r\n                }\r\n        \r\n                deltaMove = touch.getUILocation(_tempVec2);\r\n                deltaMove.subtract(touch.getUIStartLocation(_tempVec2_1));\r\n                // FIXME: touch move delta should be calculated by DPI.\r\n                if (deltaMove.length() > 7) {\r\n                    if (!this._touchMoved && event.target !== this.node) {\r\n                        // Simulate touch cancel for target node\r\n                        const cancelEvent = new EventTouch(event.getTouches(), event.bubbles, SystemEventType.TOUCH_CANCEL);\r\n                        cancelEvent.touch = event.touch;\r\n                        cancelEvent.simulate = true;\r\n                        (event.target as Node).dispatchEvent(cancelEvent);\r\n                        this._touchMoved = true;\r\n                    }\r\n                }\r\n                this._stopPropagationIfTargetIsMe(event);\r\n            }\r\n        }else{\r\n            t._scrollView._hasNestedViewGroup = function (event: EventTouch, captureListeners?: Node[]) {\r\n                if (!event || event.eventPhase !== Event.CAPTURING_PHASE) {\r\n                    return false;\r\n                }\r\n        \r\n                if (captureListeners) {\r\n                    // captureListeners are arranged from child to parent\r\n                    for (const listener of captureListeners) {\r\n                        const item = listener;\r\n        \r\n                        if (this.node === item) {\r\n                            if (event.target && (event.target as Node).getComponent(ViewGroup)) {\r\n                                let deltaMove = event.getUIDelta();\r\n                                // console.log(deltaMove.x,deltaMove.y,t.node.parent.name);\r\n                                if(deltaMove.x > 10 || deltaMove.x < -10) {\r\n                                    // console.log(deltaMove.x,1111,t.node.parent.name);\r\n                                    return true;\r\n                                }\r\n                                return false;\r\n                            }\r\n                            return false;\r\n                        }\r\n        \r\n                        if (item.getComponent(ViewGroup)) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            t._scrollView._onTouchMoved = function (event: EventTouch, captureListeners?: Node[]) {\r\n                if (!this.enabledInHierarchy || !this._content) { return; }\r\n                       \r\n                const touch = event.touch!;\r\n                let deltaMove = touch.getUIDelta();\r\n                // console.log(deltaMove.x,deltaMove.y,t.node.parent.name);\r\n                if(deltaMove.x > 10 || deltaMove.x < -10) {\r\n                    // console.log(deltaMove.x,1111,t.node.parent.name);\r\n                    // this._dispatchEvent(ScrollView.EventType.TOUCH_UP);\r\n                    return;\r\n                }\r\n                \r\n                this._handleMoveLogic(touch);\r\n        \r\n                // Do not prevent touch events in inner nodes\r\n                if (!this.cancelInnerEvents) {\r\n                    return;\r\n                }\r\n        \r\n                deltaMove = touch.getUILocation(_tempVec2);\r\n                deltaMove.subtract(touch.getUIStartLocation(_tempVec2_1));\r\n                // FIXME: touch move delta should be calculated by DPI.\r\n                if (deltaMove.length() > 7) {\r\n                    if (!this._touchMoved && event.target !== this.node) {\r\n                        // Simulate touch cancel for target node\r\n                        const cancelEvent = new EventTouch(event.getTouches(), event.bubbles, SystemEventType.TOUCH_CANCEL);\r\n                        cancelEvent.touch = event.touch;\r\n                        cancelEvent.simulate = true;\r\n                        (event.target as Node).dispatchEvent(cancelEvent);\r\n                        this._touchMoved = true;\r\n                    }\r\n                }\r\n\r\n                event.propagationStopped = true;\r\n            }\r\n\r\n            t._scrollView._onTouchEnded = function (event: EventTouch, captureListeners?: Node[]) {\r\n                if (!this.enabledInHierarchy || !this._content) { return; }\r\n                       \r\n                this._dispatchEvent(ScrollView.EventType.TOUCH_UP);\r\n\r\n                const touch = event.touch!;\r\n                this._handleReleaseLogic(touch);\r\n        \r\n                if (this._touchMoved) {\r\n                    event.propagationStopped = true;\r\n                    this._touchMoved = false;\r\n                } else {\r\n                    this._stopPropagationIfTargetIsMe(event);\r\n                }\r\n            }\r\n\r\n            t._scrollView._onTouchCancelled = function (event: EventTouch, captureListeners?: Node[]) {\r\n                if (!this.enabledInHierarchy || !this._content) { return; }\r\n                       \r\n                 // Filter touch cancel event send from self\r\n                    if (event && !event.simulate) {\r\n                        const touch = event.touch!;\r\n                        this._handleReleaseLogic(touch);\r\n                    }\r\n                    this._touchMoved = false;\r\n                    this._stopPropagationIfTargetIsMe(event);\r\n            }\r\n        }\r\n\r\n    \r\n        if (!t.virtual)         // lackCenter 仅支持 Virtual 模式\r\n            t.lackCenter = false;\r\n\r\n        t._lastDisplayData = []; //最后一次刷新的数据\r\n        t.displayData = []; //当前数据\r\n        t._pool = new NodePool();    //这是个池子..\r\n        t._forceUpdate = false;         //是否强制更新\r\n        t._updateCounter = 0;           //当前分帧渲染帧数\r\n        t._updateDone = true;           //分帧渲染是否完成\r\n\r\n        t.curPageNum = 0;               //当前页数\r\n\r\n        if (t.cyclic || 0) {\r\n            t._scrollView._processAutoScrolling = this._processAutoScrolling.bind(t);\r\n            t._scrollView._startBounceBackIfNeeded = function () {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        switch (t._align) {\r\n            case Layout.Type.HORIZONTAL: {\r\n                switch (t._horizontalDir) {\r\n                    case Layout.HorizontalDirection.LEFT_TO_RIGHT:\r\n                        t._alignCalcType = 1;\r\n                        break;\r\n                    case Layout.HorizontalDirection.RIGHT_TO_LEFT:\r\n                        t._alignCalcType = 2;\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n            case Layout.Type.VERTICAL: {\r\n                switch (t._verticalDir) {\r\n                    case Layout.VerticalDirection.TOP_TO_BOTTOM:\r\n                        t._alignCalcType = 3;\r\n                        break;\r\n                    case Layout.VerticalDirection.BOTTOM_TO_TOP:\r\n                        t._alignCalcType = 4;\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n            case Layout.Type.GRID: {\r\n                switch (t._startAxis) {\r\n                    case Layout.AxisDirection.HORIZONTAL:\r\n                        switch (t._verticalDir) {\r\n                            case Layout.VerticalDirection.TOP_TO_BOTTOM:\r\n                                t._alignCalcType = 3;\r\n                                break;\r\n                            case Layout.VerticalDirection.BOTTOM_TO_TOP:\r\n                                t._alignCalcType = 4;\r\n                                break;\r\n                        }\r\n                        break;\r\n                    case Layout.AxisDirection.VERTICAL:\r\n                        switch (t._horizontalDir) {\r\n                            case Layout.HorizontalDirection.LEFT_TO_RIGHT:\r\n                                t._alignCalcType = 1;\r\n                                break;\r\n                            case Layout.HorizontalDirection.RIGHT_TO_LEFT:\r\n                                t._alignCalcType = 2;\r\n                                break;\r\n                        }\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        // 清空 content\r\n        // t.content.children.forEach((child: Node) => {\r\n        //     child.removeFromParent();\r\n        //     if (child != t.tmpNode && child.isValid)\r\n        //         child.destroy();\r\n        // });\r\n        t.content.removeAllChildren();\r\n        t._inited = true;\r\n    }\r\n    /**\r\n     * 为了实现循环列表，必须覆写cc.ScrollView的某些函数\r\n     * @param {Number} dt\r\n     */\r\n    _processAutoScrolling(dt: number) {\r\n\r\n        // ------------- scroll-view 里定义的一些常量 -------------\r\n        const OUT_OF_BOUNDARY_BREAKING_FACTOR = 0.05;\r\n        const EPSILON = 1e-4;\r\n        const ZERO = new Vec3();\r\n        const quintEaseOut = (time: number) => {\r\n            time -= 1;\r\n            return (time * time * time * time * time + 1);\r\n        };\r\n        // ------------- scroll-view 里定义的一些常量 -------------\r\n\r\n        let sv: ScrollView = this._scrollView;\r\n\r\n        const isAutoScrollBrake = sv['_isNecessaryAutoScrollBrake']();\r\n        const brakingFactor = isAutoScrollBrake ? OUT_OF_BOUNDARY_BREAKING_FACTOR : 1;\r\n        sv['_autoScrollAccumulatedTime'] += dt * (1 / brakingFactor);\r\n\r\n        let percentage = Math.min(1, sv['_autoScrollAccumulatedTime'] / sv['_autoScrollTotalTime']);\r\n        if (sv['_autoScrollAttenuate']) {\r\n            percentage = quintEaseOut(percentage);\r\n        }\r\n\r\n        const clonedAutoScrollTargetDelta = sv['_autoScrollTargetDelta'].clone();\r\n        clonedAutoScrollTargetDelta.multiplyScalar(percentage);\r\n        const clonedAutoScrollStartPosition = sv['_autoScrollStartPosition'].clone();\r\n        clonedAutoScrollStartPosition.add(clonedAutoScrollTargetDelta);\r\n        let reachedEnd = Math.abs(percentage - 1) <= EPSILON;\r\n\r\n        const fireEvent = Math.abs(percentage - 1) <= sv['getScrollEndedEventTiming']();\r\n        if (fireEvent && !sv['_isScrollEndedWithThresholdEventFired']) {\r\n            sv['_dispatchEvent'](ScrollView.EventType.SCROLL_ENG_WITH_THRESHOLD);\r\n            sv['_isScrollEndedWithThresholdEventFired'] = true;\r\n        }\r\n\r\n        if (sv['elastic']) {\r\n            const brakeOffsetPosition = clonedAutoScrollStartPosition.clone();\r\n            brakeOffsetPosition.subtract(sv['_autoScrollBrakingStartPosition']);\r\n            if (isAutoScrollBrake) {\r\n                brakeOffsetPosition.multiplyScalar(brakingFactor);\r\n            }\r\n            clonedAutoScrollStartPosition.set(sv['_autoScrollBrakingStartPosition']);\r\n            clonedAutoScrollStartPosition.add(brakeOffsetPosition);\r\n        } else {\r\n            const moveDelta = clonedAutoScrollStartPosition.clone();\r\n            moveDelta.subtract(sv['_getContentPosition']());\r\n            const outOfBoundary = sv['_getHowMuchOutOfBoundary'](moveDelta);\r\n            if (!outOfBoundary.equals(ZERO, EPSILON)) {\r\n                clonedAutoScrollStartPosition.add(outOfBoundary);\r\n                reachedEnd = true;\r\n            }\r\n        }\r\n\r\n        if (reachedEnd) {\r\n            sv['_autoScrolling'] = false;\r\n        }\r\n\r\n        const deltaMove = new Vec3(clonedAutoScrollStartPosition);\r\n        deltaMove.subtract(sv['_getContentPosition']());\r\n        sv['_clampDelta'](deltaMove);\r\n        sv['_moveContent'](deltaMove, reachedEnd);\r\n        sv['_dispatchEvent'](ScrollView.EventType.SCROLLING);\r\n\r\n        if (!sv['_autoScrolling']) {\r\n            sv['_isBouncing'] = false;\r\n            sv['_scrolling'] = false;\r\n            sv['_dispatchEvent'](ScrollView.EventType.SCROLL_ENDED);\r\n        }\r\n    }\r\n    //设置模板Item\r\n    setTemplateItem(item: any) {\r\n        if (!item)\r\n            return;\r\n        let t: any = this;\r\n        t._itemTmp = item;\r\n        t._itemTmpUt = item.getComponent(UITransform);\r\n\r\n        if (t._resizeMode == Layout.ResizeMode.CHILDREN)\r\n            t._itemSize = t._layout.cellSize;\r\n        else {\r\n            let itemUt: UITransform = item.getComponent(UITransform);\r\n            t._itemSize = new Size(itemUt.width, itemUt.height);\r\n        }\r\n\r\n        //获取ListItem，如果没有就取消选择模式\r\n        let com: any = item.getComponent(ListItem);\r\n        let remove = false;\r\n        if (!com)\r\n            remove = true;\r\n        // if (com) {\r\n        //     if (!com._btnCom && !item.getComponent(cc.Button)) {\r\n        //         remove = true;\r\n        //     }\r\n        // }\r\n        if (remove) {\r\n            t.selectedMode = SelectedType.NONE;\r\n        }\r\n        com = item.getComponent(Widget);\r\n        if (com && com.enabled) {\r\n            t._needUpdateWidget = true;\r\n        }\r\n        if (t.selectedMode == SelectedType.MULT)\r\n            t.multSelected = [];\r\n\r\n        switch (t._align) {\r\n            case Layout.Type.HORIZONTAL:\r\n                t._colLineNum = 1;\r\n                t._sizeType = false;\r\n                break;\r\n            case Layout.Type.VERTICAL:\r\n                t._colLineNum = 1;\r\n                t._sizeType = true;\r\n                break;\r\n            case Layout.Type.GRID:\r\n                switch (t._startAxis) {\r\n                    case Layout.AxisDirection.HORIZONTAL:\r\n                        //计算列数\r\n                        let trimW: number = t._contentUt.width - t._leftGap - t._rightGap;\r\n                        t._colLineNum = Math.floor((trimW + t._columnGap) / (t._itemSize.width + t._columnGap));\r\n                        t._sizeType = true;\r\n                        break;\r\n                    case Layout.AxisDirection.VERTICAL:\r\n                        //计算行数\r\n                        let trimH: number = t._contentUt.height - t._topGap - t._bottomGap;\r\n                        t._colLineNum = Math.floor((trimH + t._lineGap) / (t._itemSize.height + t._lineGap));\r\n                        t._sizeType = false;\r\n                        break;\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * 检查是否初始化\r\n     * @param {Boolean} printLog 是否打印错误信息\r\n     * @returns\r\n     */\r\n    checkInited(printLog: boolean = true) {\r\n        if (!this._inited) {\r\n            if (printLog)\r\n                console.error('List initialization not completed!');\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    //禁用 Layout 组件，自行计算 Content Size\r\n    _resizeContent() {\r\n        let t: any = this;\r\n        let result: number;\r\n\r\n        switch (t._align) {\r\n            case Layout.Type.HORIZONTAL: {\r\n                if (t._customSize) {\r\n                    let fixed: any = t._getFixedSize(null);\r\n                    result = t._leftGap + fixed.val + (t._itemSize.width * (t._numItems - fixed.count)) + (t._columnGap * (t._numItems - 1)) + t._rightGap;\r\n                } else {\r\n                    result = t._leftGap + (t._itemSize.width * t._numItems) + (t._columnGap * (t._numItems - 1)) + t._rightGap;\r\n                }\r\n                break;\r\n            }\r\n            case Layout.Type.VERTICAL: {\r\n                if (t._customSize) {\r\n                    let fixed: any = t._getFixedSize(null);\r\n                    result = t._topGap + fixed.val + (t._itemSize.height * (t._numItems - fixed.count)) + (t._lineGap * (t._numItems - 1)) + t._bottomGap;\r\n                } else {\r\n                    result = t._topGap + (t._itemSize.height * t._numItems) + (t._lineGap * (t._numItems - 1)) + t._bottomGap;\r\n                }\r\n                break;\r\n            }\r\n            case Layout.Type.GRID: {\r\n                //网格模式不支持居中\r\n                if (t.lackCenter)\r\n                    t.lackCenter = false;\r\n                switch (t._startAxis) {\r\n                    case Layout.AxisDirection.HORIZONTAL:\r\n                        let lineNum: number = Math.ceil(t._numItems / t._colLineNum);\r\n                        result = t._topGap + (t._itemSize.height * lineNum) + (t._lineGap * (lineNum - 1)) + t._bottomGap;\r\n                        break;\r\n                    case Layout.AxisDirection.VERTICAL:\r\n                        let colNum: number = Math.ceil(t._numItems / t._colLineNum);\r\n                        result = t._leftGap + (t._itemSize.width * colNum) + (t._columnGap * (colNum - 1)) + t._rightGap;\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        let layout: Layout = t.content.getComponent(Layout);\r\n        if (layout)\r\n            layout.enabled = false;\r\n\r\n        t._allItemSize = result;\r\n        t._allItemSizeNoEdge = t._allItemSize - (t._sizeType ? (t._topGap + t._bottomGap) : (t._leftGap + t._rightGap));\r\n\r\n        if (t.cyclic) {\r\n            let totalSize: number = (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width);\r\n\r\n            t._cyclicPos1 = 0;\r\n            totalSize -= t._cyclicPos1;\r\n            t._cyclicNum = Math.ceil(totalSize / t._allItemSizeNoEdge) + 1;\r\n            let spacing: number = t._sizeType ? t._lineGap : t._columnGap;\r\n            t._cyclicPos2 = t._cyclicPos1 + t._allItemSizeNoEdge + spacing;\r\n            t._cyclicAllItemSize = t._allItemSize + (t._allItemSizeNoEdge * (t._cyclicNum - 1)) + (spacing * (t._cyclicNum - 1));\r\n            t._cycilcAllItemSizeNoEdge = t._allItemSizeNoEdge * t._cyclicNum;\r\n            t._cycilcAllItemSizeNoEdge += spacing * (t._cyclicNum - 1);\r\n            // cc.log('_cyclicNum ->', t._cyclicNum, t._allItemSizeNoEdge, t._allItemSize, t._cyclicPos1, t._cyclicPos2);\r\n        }\r\n\r\n        t._lack = !t.cyclic && t._allItemSize < (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width);\r\n        let slideOffset: number = ((!t._lack || !t.lackCenter) && t.lackSlide) ? 0 : .1;\r\n\r\n        let targetWH: number = t._lack ? ((t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width) - slideOffset) : (t.cyclic ? t._cyclicAllItemSize : t._allItemSize);\r\n        if (targetWH < 0)\r\n            targetWH = 0;\r\n\r\n        if (t._sizeType) {\r\n            t._contentUt.height = targetWH;\r\n        } else {\r\n            t._contentUt.width = targetWH;\r\n        }\r\n\r\n        // cc.log('_resizeContent()  numItems =', t._numItems, '，content =', t.content);\r\n    }\r\n\r\n    //滚动进行时...\r\n    _onScrolling(ev: Event = null) {\r\n        if (this.frameCount == null)\r\n            this.frameCount = this._updateRate;\r\n        if (!this._forceUpdate && (ev && ev.type != 'scroll-ended') && this.frameCount > 0) {\r\n            this.frameCount--;\r\n            return;\r\n        } else\r\n            this.frameCount = this._updateRate;\r\n\r\n        if (this._aniDelRuning)\r\n            return;\r\n\r\n        //循环列表处理\r\n        if (this.cyclic) {\r\n            let scrollPos: any = this.content.getPosition();\r\n            scrollPos = this._sizeType ? scrollPos.y : scrollPos.x;\r\n\r\n            let addVal = this._allItemSizeNoEdge + (this._sizeType ? this._lineGap : this._columnGap);\r\n            let add: any = this._sizeType ? new Vec3(0, addVal, 0) : new Vec3(addVal, 0, 0);\r\n\r\n            let contentPos = this.content.getPosition();\r\n\r\n            switch (this._alignCalcType) {\r\n                case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                    if (scrollPos > -this._cyclicPos1) {\r\n                        contentPos.set(-this._cyclicPos2, contentPos.y, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].subtract(add);\r\n                        }\r\n                        // if (this._beganPos) {\r\n                        //     this._beganPos += add;\r\n                        // }\r\n                    } else if (scrollPos < -this._cyclicPos2) {\r\n                        contentPos.set(-this._cyclicPos1, contentPos.y, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].add(add);\r\n                        }\r\n                        // if (this._beganPos) {\r\n                        //     this._beganPos -= add;\r\n                        // }\r\n                    }\r\n                    break;\r\n                case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                    if (scrollPos < this._cyclicPos1) {\r\n                        contentPos.set(this._cyclicPos2, contentPos.y, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].add(add);\r\n                        }\r\n                    } else if (scrollPos > this._cyclicPos2) {\r\n                        contentPos.set(this._cyclicPos1, contentPos.y, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].subtract(add);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                    if (scrollPos < this._cyclicPos1) {\r\n                        contentPos.set(contentPos.x, this._cyclicPos2, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].add(add);\r\n                        }\r\n                    } else if (scrollPos > this._cyclicPos2) {\r\n                        contentPos.set(contentPos.x, this._cyclicPos1, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].subtract(add);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                    if (scrollPos > -this._cyclicPos1) {\r\n                        contentPos.set(contentPos.x, -this._cyclicPos2, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].subtract(add);\r\n                        }\r\n                    } else if (scrollPos < -this._cyclicPos2) {\r\n                        contentPos.set(contentPos.x, -this._cyclicPos1, contentPos.z);\r\n                        this.content.setPosition(contentPos);\r\n                        if (this._scrollView.isAutoScrolling()) {\r\n                            this._scrollView['_autoScrollStartPosition'] = this._scrollView['_autoScrollStartPosition'].add(add);\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        this._calcViewPos();\r\n\r\n        let vTop: number, vRight: number, vBottom: number, vLeft: number;\r\n        if (this._sizeType) {\r\n            vTop = this.viewTop;\r\n            vBottom = this.viewBottom;\r\n        } else {\r\n            vRight = this.viewRight;\r\n            vLeft = this.viewLeft;\r\n        }\r\n\r\n        if (this._virtual) {\r\n            this.displayData = [];\r\n            let itemPos: any;\r\n\r\n            let curId: number = 0;\r\n            let endId: number = this._numItems - 1;\r\n\r\n            if (this._customSize) {\r\n                let breakFor: boolean = false;\r\n                //如果该item的位置在可视区域内，就推入displayData\r\n                for (; curId <= endId && !breakFor; curId++) {\r\n                    itemPos = this._calcItemPos(curId);\r\n                    switch (this._align) {\r\n                        case Layout.Type.HORIZONTAL:\r\n                            if (itemPos.right >= vLeft && itemPos.left <= vRight) {\r\n                                this.displayData.push(itemPos);\r\n                            } else if (curId != 0 && this.displayData.length > 0) {\r\n                                breakFor = true;\r\n                            }\r\n                            break;\r\n                        case Layout.Type.VERTICAL:\r\n                            if (itemPos.bottom <= vTop && itemPos.top >= vBottom) {\r\n                                this.displayData.push(itemPos);\r\n                            } else if (curId != 0 && this.displayData.length > 0) {\r\n                                breakFor = true;\r\n                            }\r\n                            break;\r\n                        case Layout.Type.GRID:\r\n                            switch (this._startAxis) {\r\n                                case Layout.AxisDirection.HORIZONTAL:\r\n                                    if (itemPos.bottom <= vTop && itemPos.top >= vBottom) {\r\n                                        this.displayData.push(itemPos);\r\n                                    } else if (curId != 0 && this.displayData.length > 0) {\r\n                                        breakFor = true;\r\n                                    }\r\n                                    break;\r\n                                case Layout.AxisDirection.VERTICAL:\r\n                                    if (itemPos.right >= vLeft && itemPos.left <= vRight) {\r\n                                        this.displayData.push(itemPos);\r\n                                    } else if (curId != 0 && this.displayData.length > 0) {\r\n                                        breakFor = true;\r\n                                    }\r\n                                    break;\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n            } else {\r\n                let ww: number = this._itemSize.width + this._columnGap;\r\n                let hh: number = this._itemSize.height + this._lineGap;\r\n                switch (this._alignCalcType) {\r\n                    case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                        curId = (vLeft - this._leftGap) / ww;\r\n                        endId = (vRight - this._leftGap) / ww;\r\n                        break;\r\n                    case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                        curId = (-vRight - this._rightGap) / ww;\r\n                        endId = (-vLeft - this._rightGap) / ww;\r\n                        break;\r\n                    case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                        curId = (-vTop - this._topGap) / hh;\r\n                        endId = (-vBottom - this._topGap) / hh;\r\n                        break;\r\n                    case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                        curId = (vBottom - this._bottomGap) / hh;\r\n                        endId = (vTop - this._bottomGap) / hh;\r\n                        break;\r\n                }\r\n                curId = Math.floor(curId) * this._colLineNum;\r\n                endId = Math.ceil(endId) * this._colLineNum;\r\n                endId--;\r\n                if (curId < 0)\r\n                    curId = 0;\r\n                if (endId >= this._numItems)\r\n                    endId = this._numItems - 1;\r\n                for (; curId <= endId; curId++) {\r\n                    this.displayData.push(this._calcItemPos(curId));\r\n                }\r\n            }\r\n            this._delRedundantItem();\r\n            if (this.displayData.length <= 0 || !this._numItems) { //if none, delete all.\r\n                this._lastDisplayData = [];\r\n                return;\r\n            }\r\n            this.firstListId = this.displayData[0].id;\r\n            this.displayItemNum = this.displayData.length;\r\n\r\n            let len: number = this._lastDisplayData.length;\r\n\r\n            let haveDataChange: boolean = this.displayItemNum != len;\r\n            if (haveDataChange) {\r\n                // 如果是逐帧渲染，需要排序\r\n                if (this.frameByFrameRenderNum > 0) {\r\n                    this._lastDisplayData.sort((a, b) => { return a - b });\r\n                }\r\n                // 因List的显示数据是有序的，所以只需要判断数组长度是否相等，以及头、尾两个元素是否相等即可。\r\n                haveDataChange = this.firstListId != this._lastDisplayData[0] || this.displayData[this.displayItemNum - 1].id != this._lastDisplayData[len - 1];\r\n            }\r\n\r\n            if (this._forceUpdate || haveDataChange) {    //如果是强制更新\r\n                if (this.frameByFrameRenderNum > 0) {\r\n                    // if (this._updateDone) {\r\n                    // this._lastDisplayData = [];\r\n                    //逐帧渲染\r\n                    if (this._numItems > 0) {\r\n                        if (!this._updateDone) {\r\n                            this._doneAfterUpdate = true;\r\n                        } else {\r\n                            this._updateCounter = 0;\r\n                        }\r\n                        this._updateDone = false;\r\n                    } else {\r\n                        this._updateCounter = 0;\r\n                        this._updateDone = true;\r\n                    }\r\n                    // }\r\n                } else {\r\n                    //直接渲染\r\n                    this._lastDisplayData = [];\r\n                    // cc.log('List Display Data II::', this.displayData);\r\n                    for (let c = 0; c < this.displayItemNum; c++) {\r\n                        this._createOrUpdateItem(this.displayData[c]);\r\n                    }\r\n                    this._forceUpdate = false;\r\n                }\r\n            }\r\n            this._calcNearestItem();\r\n        }\r\n    }\r\n    //计算可视范围\r\n    _calcViewPos() {\r\n        let scrollPos: any = this.content.getPosition();\r\n        switch (this._alignCalcType) {\r\n            case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                this.elasticLeft = scrollPos.x > 0 ? scrollPos.x : 0;\r\n                this.viewLeft = (scrollPos.x < 0 ? -scrollPos.x : 0) - this.elasticLeft;\r\n\r\n                this.viewRight = this.viewLeft + this._thisNodeUt.width;\r\n                this.elasticRight = this.viewRight > this._contentUt.width ? Math.abs(this.viewRight - this._contentUt.width) : 0;\r\n                this.viewRight += this.elasticRight;\r\n                // cc.log(this.elasticLeft, this.elasticRight, this.viewLeft, this.viewRight);\r\n                break;\r\n            case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                this.elasticRight = scrollPos.x < 0 ? -scrollPos.x : 0;\r\n                this.viewRight = (scrollPos.x > 0 ? -scrollPos.x : 0) + this.elasticRight;\r\n                this.viewLeft = this.viewRight - this._thisNodeUt.width;\r\n                this.elasticLeft = this.viewLeft < -this._contentUt.width ? Math.abs(this.viewLeft + this._contentUt.width) : 0;\r\n                this.viewLeft -= this.elasticLeft;\r\n                // cc.log(this.elasticLeft, this.elasticRight, this.viewLeft, this.viewRight);\r\n                break;\r\n            case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                this.elasticTop = scrollPos.y < 0 ? Math.abs(scrollPos.y) : 0;\r\n                this.viewTop = (scrollPos.y > 0 ? -scrollPos.y : 0) + this.elasticTop;\r\n                this.viewBottom = this.viewTop - this._thisNodeUt.height;\r\n                this.elasticBottom = this.viewBottom < -this._contentUt.height ? Math.abs(this.viewBottom + this._contentUt.height) : 0;\r\n                this.viewBottom += this.elasticBottom;\r\n                // cc.log(this.elasticTop, this.elasticBottom, this.viewTop, this.viewBottom);\r\n                break;\r\n            case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                this.elasticBottom = scrollPos.y > 0 ? Math.abs(scrollPos.y) : 0;\r\n                this.viewBottom = (scrollPos.y < 0 ? -scrollPos.y : 0) - this.elasticBottom;\r\n                this.viewTop = this.viewBottom + this._thisNodeUt.height;\r\n                this.elasticTop = this.viewTop > this._contentUt.height ? Math.abs(this.viewTop - this._contentUt.height) : 0;\r\n                this.viewTop -= this.elasticTop;\r\n                // cc.log(this.elasticTop, this.elasticBottom, this.viewTop, this.viewBottom);\r\n                break;\r\n        }\r\n    }\r\n    //计算位置 根据id\r\n    _calcItemPos(id: number) {\r\n        let width: number, height: number, top: number, bottom: number, left: number, right: number, itemX: number, itemY: number;\r\n        switch (this._align) {\r\n            case Layout.Type.HORIZONTAL:\r\n                switch (this._horizontalDir) {\r\n                    case Layout.HorizontalDirection.LEFT_TO_RIGHT: {\r\n                        if (this._customSize) {\r\n                            let fixed: any = this._getFixedSize(id);\r\n                            left = this._leftGap + ((this._itemSize.width + this._columnGap) * (id - fixed.count)) + (fixed.val + (this._columnGap * fixed.count));\r\n                            let cs: number = this._customSize[id];\r\n                            width = (cs > 0 ? cs : this._itemSize.width);\r\n                        } else {\r\n                            left = this._leftGap + ((this._itemSize.width + this._columnGap) * id);\r\n                            width = this._itemSize.width;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            left -= this._leftGap;\r\n                            let offset: number = (this._contentUt.width / 2) - (this._allItemSizeNoEdge / 2);\r\n                            left += offset;\r\n                        }\r\n                        right = left + width;\r\n                        return {\r\n                            id: id,\r\n                            left: left,\r\n                            right: right,\r\n                            x: left + (this._itemTmpUt.anchorX * width),\r\n                            y: this._itemTmp.y,\r\n                        };\r\n                    }\r\n                    case Layout.HorizontalDirection.RIGHT_TO_LEFT: {\r\n                        if (this._customSize) {\r\n                            let fixed: any = this._getFixedSize(id);\r\n                            right = -this._rightGap - ((this._itemSize.width + this._columnGap) * (id - fixed.count)) - (fixed.val + (this._columnGap * fixed.count));\r\n                            let cs: number = this._customSize[id];\r\n                            width = (cs > 0 ? cs : this._itemSize.width);\r\n                        } else {\r\n                            right = -this._rightGap - ((this._itemSize.width + this._columnGap) * id);\r\n                            width = this._itemSize.width;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            right += this._rightGap;\r\n                            let offset: number = (this._contentUt.width / 2) - (this._allItemSizeNoEdge / 2);\r\n                            right -= offset;\r\n                        }\r\n                        left = right - width;\r\n                        return {\r\n                            id: id,\r\n                            right: right,\r\n                            left: left,\r\n                            x: left + (this._itemTmpUt.anchorX * width),\r\n                            y: this._itemTmp.y,\r\n                        };\r\n                    }\r\n                }\r\n                break;\r\n            case Layout.Type.VERTICAL: {\r\n                switch (this._verticalDir) {\r\n                    case Layout.VerticalDirection.TOP_TO_BOTTOM: {\r\n                        if (this._customSize) {\r\n                            let fixed: any = this._getFixedSize(id);\r\n                            top = -this._topGap - ((this._itemSize.height + this._lineGap) * (id - fixed.count)) - (fixed.val + (this._lineGap * fixed.count));\r\n                            let cs: number = this._customSize[id];\r\n                            height = (cs > 0 ? cs : this._itemSize.height);\r\n                        } else {\r\n                            top = -this._topGap - ((this._itemSize.height + this._lineGap) * id);\r\n                            height = this._itemSize.height;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            top += this._topGap;\r\n                            let offset: number = (this._contentUt.height / 2) - (this._allItemSizeNoEdge / 2);\r\n                            top -= offset;\r\n                        }\r\n                        bottom = top - height;\r\n                        return {\r\n                            id: id,\r\n                            top: top,\r\n                            bottom: bottom,\r\n                            x: this._itemTmp.x,\r\n                            y: bottom + (this._itemTmpUt.anchorY * height),\r\n                        };\r\n                    }\r\n                    case Layout.VerticalDirection.BOTTOM_TO_TOP: {\r\n                        if (this._customSize) {\r\n                            let fixed: any = this._getFixedSize(id);\r\n                            bottom = this._bottomGap + ((this._itemSize.height + this._lineGap) * (id - fixed.count)) + (fixed.val + (this._lineGap * fixed.count));\r\n                            let cs: number = this._customSize[id];\r\n                            height = (cs > 0 ? cs : this._itemSize.height);\r\n                        } else {\r\n                            bottom = this._bottomGap + ((this._itemSize.height + this._lineGap) * id);\r\n                            height = this._itemSize.height;\r\n                        }\r\n                        if (this.lackCenter) {\r\n                            bottom -= this._bottomGap;\r\n                            let offset: number = (this._contentUt.height / 2) - (this._allItemSizeNoEdge / 2);\r\n                            bottom += offset;\r\n                        }\r\n                        top = bottom + height;\r\n                        return {\r\n                            id: id,\r\n                            top: top,\r\n                            bottom: bottom,\r\n                            x: this._itemTmp.x,\r\n                            y: bottom + (this._itemTmpUt.anchorY * height),\r\n                        };\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            case Layout.Type.GRID: {\r\n                let colLine: number = Math.floor(id / this._colLineNum);\r\n                switch (this._startAxis) {\r\n                    case Layout.AxisDirection.HORIZONTAL: {\r\n                        switch (this._verticalDir) {\r\n                            case Layout.VerticalDirection.TOP_TO_BOTTOM: {\r\n                                top = -this._topGap - ((this._itemSize.height + this._lineGap) * colLine);\r\n                                bottom = top - this._itemSize.height;\r\n                                itemY = bottom + (this._itemTmpUt.anchorY * this._itemSize.height);\r\n                                break;\r\n                            }\r\n                            case Layout.VerticalDirection.BOTTOM_TO_TOP: {\r\n                                bottom = this._bottomGap + ((this._itemSize.height + this._lineGap) * colLine);\r\n                                top = bottom + this._itemSize.height;\r\n                                itemY = bottom + (this._itemTmpUt.anchorY * this._itemSize.height);\r\n                                break;\r\n                            }\r\n                        }\r\n                        itemX = this._leftGap + ((id % this._colLineNum) * (this._itemSize.width + this._columnGap));\r\n                        switch (this._horizontalDir) {\r\n                            case Layout.HorizontalDirection.LEFT_TO_RIGHT: {\r\n                                itemX += (this._itemTmpUt.anchorX * this._itemSize.width);\r\n                                itemX -= (this._contentUt.anchorX * this._contentUt.width);\r\n                                break;\r\n                            }\r\n                            case Layout.HorizontalDirection.RIGHT_TO_LEFT: {\r\n                                itemX += ((1 - this._itemTmpUt.anchorX) * this._itemSize.width);\r\n                                itemX -= ((1 - this._contentUt.anchorX) * this._contentUt.width);\r\n                                itemX *= -1;\r\n                                break;\r\n                            }\r\n                        }\r\n                        return {\r\n                            id: id,\r\n                            top: top,\r\n                            bottom: bottom,\r\n                            x: itemX,\r\n                            y: itemY,\r\n                        };\r\n                    }\r\n                    case Layout.AxisDirection.VERTICAL: {\r\n                        switch (this._horizontalDir) {\r\n                            case Layout.HorizontalDirection.LEFT_TO_RIGHT: {\r\n                                left = this._leftGap + ((this._itemSize.width + this._columnGap) * colLine);\r\n                                right = left + this._itemSize.width;\r\n                                itemX = left + (this._itemTmpUt.anchorX * this._itemSize.width);\r\n                                itemX -= (this._contentUt.anchorX * this._contentUt.width);\r\n                                break;\r\n                            }\r\n                            case Layout.HorizontalDirection.RIGHT_TO_LEFT: {\r\n                                right = -this._rightGap - ((this._itemSize.width + this._columnGap) * colLine);\r\n                                left = right - this._itemSize.width;\r\n                                itemX = left + (this._itemTmpUt.anchorX * this._itemSize.width);\r\n                                itemX += ((1 - this._contentUt.anchorX) * this._contentUt.width);\r\n                                break;\r\n                            }\r\n                        }\r\n                        itemY = -this._topGap - ((id % this._colLineNum) * (this._itemSize.height + this._lineGap));\r\n                        switch (this._verticalDir) {\r\n                            case Layout.VerticalDirection.TOP_TO_BOTTOM: {\r\n                                itemY -= ((1 - this._itemTmpUt.anchorY) * this._itemSize.height);\r\n                                itemY += ((1 - this._contentUt.anchorY) * this._contentUt.height);\r\n                                break;\r\n                            }\r\n                            case Layout.VerticalDirection.BOTTOM_TO_TOP: {\r\n                                itemY -= ((this._itemTmpUt.anchorY) * this._itemSize.height);\r\n                                itemY += (this._contentUt.anchorY * this._contentUt.height);\r\n                                itemY *= -1;\r\n                                break;\r\n                            }\r\n                        }\r\n                        return {\r\n                            id: id,\r\n                            left: left,\r\n                            right: right,\r\n                            x: itemX,\r\n                            y: itemY,\r\n                        };\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    //计算已存在的Item的位置\r\n    _calcExistItemPos(id: number) {\r\n        let item: any = this.getItemByListId(id);\r\n        if (!item)\r\n            return null;\r\n        let ut: UITransform = item.getComponent(UITransform);\r\n        let pos: Vec3 = item.getPosition();\r\n        let data: any = {\r\n            id: id,\r\n            x: pos.x,\r\n            y: pos.y,\r\n        }\r\n        if (this._sizeType) {\r\n            data.top = pos.y + (ut.height * (1 - ut.anchorY));\r\n            data.bottom = pos.y - (ut.height * ut.anchorY);\r\n        } else {\r\n            data.left = pos.x - (ut.width * ut.anchorX);\r\n            data.right = pos.x + (ut.width * (1 - ut.anchorX));\r\n        }\r\n        return data;\r\n    }\r\n    //获取Item位置\r\n    getItemPos(id: number) {\r\n        if (this._virtual)\r\n            return this._calcItemPos(id);\r\n        else {\r\n            if (this.frameByFrameRenderNum)\r\n                return this._calcItemPos(id);\r\n            else\r\n                return this._calcExistItemPos(id);\r\n        }\r\n    }\r\n    //获取固定尺寸\r\n    _getFixedSize(listId: number) {\r\n        if (!this._customSize)\r\n            return null;\r\n        if (listId == null)\r\n            listId = this._numItems;\r\n        let fixed: number = 0;\r\n        let count: number = 0;\r\n        for (let id in this._customSize) {\r\n            if (parseInt(id) < listId) {\r\n                fixed += this._customSize[id];\r\n                count++;\r\n            }\r\n        }\r\n        return {\r\n            val: fixed,\r\n            count: count,\r\n        }\r\n    }\r\n    //滚动结束时..\r\n    _onScrollBegan() {\r\n        this._beganPos = this._sizeType ? this.viewTop : this.viewLeft;\r\n    }\r\n    //滚动结束时..\r\n    _onScrollEnded() {\r\n        let t: any = this;\r\n        t._curScrollIsTouch = false;\r\n        if (t.scrollToListId != null) {\r\n            let item: any = t.getItemByListId(t.scrollToListId);\r\n            t.scrollToListId = null;\r\n            if (item) {\r\n                tween(item)\r\n                    .to(.1, { scale: 1.06 })\r\n                    .to(.1, { scale: 1 })\r\n                    .start();\r\n            }\r\n        }\r\n        t._onScrolling();\r\n\r\n        if (t._slideMode == SlideType.ADHERING &&\r\n            !t.adhering\r\n        ) {\r\n            //cc.log(t.adhering, t._scrollView.isAutoScrolling(), t._scrollView.isScrolling());\r\n            t.adhere();\r\n        } else if (t._slideMode == SlideType.PAGE) {\r\n            if (t._beganPos != null && t._curScrollIsTouch) {\r\n                this._pageAdhere();\r\n            } else {\r\n                t.adhere();\r\n            }\r\n        }\r\n    }\r\n    // 触摸时\r\n    _onTouchStart(ev, captureListeners) {\r\n        if (this._scrollView['_hasNestedViewGroup'](ev, captureListeners))\r\n            return;\r\n        this._curScrollIsTouch = true;\r\n        let isMe = ev.eventPhase === Event.AT_TARGET && ev.target === this.node;\r\n        if (!isMe) {\r\n            let itemNode: any = ev.target;\r\n            while (itemNode._listId == null && itemNode.parent)\r\n                itemNode = itemNode.parent;\r\n            this._scrollItem = itemNode._listId != null ? itemNode : ev.target;\r\n        }\r\n    }\r\n    //触摸抬起时..\r\n    _onTouchUp() {\r\n        let t: any = this;\r\n        t._scrollPos = null;\r\n        if (t._slideMode == SlideType.ADHERING) {\r\n            if (this.adhering)\r\n                this._adheringBarrier = true;\r\n            t.adhere();\r\n        } else if (t._slideMode == SlideType.PAGE) {\r\n            if (t._beganPos != null) {\r\n                this._pageAdhere();\r\n            } else {\r\n                t.adhere();\r\n            }\r\n        }\r\n        this._scrollItem = null;\r\n    }\r\n    \r\n    _onTouchCancelled(ev, captureListeners) {\r\n        let t = this;\r\n        if (t._scrollView['_hasNestedViewGroup'](ev, captureListeners) || ev.simulate)\r\n            return;\r\n\r\n        t._scrollPos = null;\r\n        if (t._slideMode == SlideType.ADHERING) {\r\n            if (t.adhering)\r\n                t._adheringBarrier = true;\r\n            t.adhere();\r\n        } else if (t._slideMode == SlideType.PAGE) {\r\n            if (t._beganPos != null) {\r\n                t._pageAdhere();\r\n            } else {\r\n                t.adhere();\r\n            }\r\n        }\r\n        this._scrollItem = null;\r\n    }\r\n    //当尺寸改变\r\n    _onSizeChanged() {\r\n        if (this.checkInited(false))\r\n            this._onScrolling();\r\n    }\r\n    //当Item自适应\r\n    _onItemAdaptive(item: any) {\r\n        let ut: UITransform = item.getComponent(UITransform);\r\n        // if (this.checkInited(false)) {\r\n        if (\r\n            (!this._sizeType && ut.width != this._itemSize.width)\r\n            || (this._sizeType && ut.height != this._itemSize.height)\r\n        ) {\r\n            if (!this._customSize)\r\n                this._customSize = {};\r\n            let val = this._sizeType ? ut.height : ut.width;\r\n            if (this._customSize[item._listId] != val) {\r\n                this._customSize[item._listId] = val;\r\n                this._resizeContent();\r\n                // this.content.children.forEach((child: Node) => {\r\n                //     this._updateItemPos(child);\r\n                // });\r\n                this.updateAll();\r\n                // 如果当前正在运行 scrollTo，肯定会不准确，在这里做修正\r\n                if (this._scrollToListId != null) {\r\n                    this._scrollPos = null;\r\n                    this.unschedule(this._scrollToSo);\r\n                    this.scrollTo(this._scrollToListId, Math.max(0, this._scrollToEndTime - ((new Date()).getTime() / 1000)));\r\n                }\r\n            }\r\n        }\r\n        // }\r\n    }\r\n    //PAGE粘附\r\n    _pageAdhere() {\r\n        let t = this;\r\n        if (!t.cyclic && (t.elasticTop > 0 || t.elasticRight > 0 || t.elasticBottom > 0 || t.elasticLeft > 0))\r\n            return;\r\n        let curPos = t._sizeType ? t.viewTop : t.viewLeft;\r\n        let dis = (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width) * t.pageDistance;\r\n        let canSkip = Math.abs(t._beganPos - curPos) > dis;\r\n        if (canSkip) {\r\n            let timeInSecond = .5;\r\n            switch (t._alignCalcType) {\r\n                case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                    if (t._beganPos > curPos) {\r\n                        t.prePage(timeInSecond);\r\n                        // cc.log('_pageAdhere   PPPPPPPPPPPPPPP');\r\n                    } else {\r\n                        t.nextPage(timeInSecond);\r\n                        // cc.log('_pageAdhere   NNNNNNNNNNNNNNN');\r\n                    }\r\n                    break;\r\n                case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                    if (t._beganPos < curPos) {\r\n                        t.prePage(timeInSecond);\r\n                    } else {\r\n                        t.nextPage(timeInSecond);\r\n                    }\r\n                    break;\r\n            }\r\n        } else if (t.elasticTop <= 0 && t.elasticRight <= 0 && t.elasticBottom <= 0 && t.elasticLeft <= 0) {\r\n            t.adhere();\r\n        }\r\n        t._beganPos = null;\r\n    }\r\n    //粘附\r\n    adhere() {\r\n        let t: any = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (t.elasticTop > 0 || t.elasticRight > 0 || t.elasticBottom > 0 || t.elasticLeft > 0)\r\n            return;\r\n        t.adhering = true;\r\n        t._calcNearestItem();\r\n        let offset: number = (t._sizeType ? t._topGap : t._leftGap) / (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width);\r\n        let timeInSecond: number = .7;\r\n        t.scrollTo(t.nearestListId, timeInSecond, offset);\r\n    }\r\n    //Update..\r\n    update() {\r\n        if (this.frameByFrameRenderNum <= 0 || this._updateDone)\r\n            return;\r\n        // cc.log(this.displayData.length, this._updateCounter, this.displayData[this._updateCounter]);\r\n        if (this._virtual) {\r\n            let len: number = (this._updateCounter + this.frameByFrameRenderNum) > this.displayItemNum ? this.displayItemNum : (this._updateCounter + this.frameByFrameRenderNum);\r\n            for (let n: number = this._updateCounter; n < len; n++) {\r\n                let data: any = this.displayData[n];\r\n                if (data) {\r\n                    this._createOrUpdateItem(data);\r\n                }\r\n            }\r\n\r\n            if (this._updateCounter >= this.displayItemNum - 1) { //最后一个\r\n                if (this._doneAfterUpdate) {\r\n                    this._updateCounter = 0;\r\n                    this._updateDone = false;\r\n                    // if (!this._scrollView.isScrolling())\r\n                    this._doneAfterUpdate = false;\r\n                } else {\r\n                    this._updateDone = true;\r\n                    this._delRedundantItem();\r\n                    this._forceUpdate = false;\r\n                    this._calcNearestItem();\r\n                    if (this.slideMode == SlideType.PAGE)\r\n                        this.curPageNum = this.nearestListId;\r\n                }\r\n            } else {\r\n                this._updateCounter += this.frameByFrameRenderNum;\r\n            }\r\n        } else {\r\n            if (this._updateCounter < this._numItems) {\r\n                let len: number = (this._updateCounter + this.frameByFrameRenderNum) > this._numItems ? this._numItems : (this._updateCounter + this.frameByFrameRenderNum);\r\n                for (let n: number = this._updateCounter; n < len; n++) {\r\n                    this._createOrUpdateItem2(n);\r\n                }\r\n                this._updateCounter += this.frameByFrameRenderNum;\r\n            } else {\r\n                this._updateDone = true;\r\n                this._calcNearestItem();\r\n                if (this.slideMode == SlideType.PAGE)\r\n                    this.curPageNum = this.nearestListId;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 创建或更新Item（虚拟列表用）\r\n     * @param {Object} data 数据\r\n     */\r\n    _createOrUpdateItem(data: any) {\r\n        let item: any = this.getItemByListId(data.id);\r\n        if (!item) { //如果不存在\r\n            let canGet: boolean = this._pool.size() > 0;\r\n            if (canGet) {\r\n                item = this._pool.get();\r\n                // cc.log('从池中取出::   旧id =', item['_listId'], '，新id =', data.id, item);\r\n            } else {\r\n                item = instantiate(this._itemTmp);\r\n                // cc.log('新建::', data.id, item);\r\n            }\r\n            if (!canGet || !isValid(item)) {\r\n                item = instantiate(this._itemTmp);\r\n                canGet = false;\r\n            }\r\n            if (item._listId != data.id) {\r\n                item._listId = data.id;\r\n                let ut: UITransform = item.getComponent(UITransform);\r\n                ut.setContentSize(this._itemSize);\r\n            }\r\n            item.setPosition(new Vec3(data.x, data.y, 0));\r\n            this._resetItemSize(item);\r\n            this.content.addChild(item);\r\n            if (canGet && this._needUpdateWidget) {\r\n                let widget: Widget = item.getComponent(Widget);\r\n                if (widget)\r\n                    widget.updateAlignment();\r\n            }\r\n            item.setSiblingIndex(this.content.children.length - 1);\r\n\r\n            let listItem: ListItem = item.getComponent(ListItem);\r\n            item['listItem'] = listItem;\r\n            if (listItem) {\r\n                listItem.listId = data.id;\r\n                listItem.list = this;\r\n                listItem._registerEvent();\r\n            }\r\n            if (this.renderEvent) {\r\n                EventHandler.emitEvents([this.renderEvent], item, data.id % this._actualNumItems);\r\n            }\r\n        } else if (this._forceUpdate && this.renderEvent) { //强制更新\r\n            item.setPosition(new Vec3(data.x, data.y, 0));\r\n            this._resetItemSize(item);\r\n            // cc.log('ADD::', data.id, item);\r\n            if (this.renderEvent) {\r\n                EventHandler.emitEvents([this.renderEvent], item, data.id % this._actualNumItems);\r\n            }\r\n        }\r\n        this._resetItemSize(item);\r\n\r\n        this._updateListItem(item['listItem']);\r\n        if (this._lastDisplayData.indexOf(data.id) < 0) {\r\n            this._lastDisplayData.push(data.id);\r\n        }\r\n    }\r\n    //创建或更新Item（非虚拟列表用）\r\n    _createOrUpdateItem2(listId: number) {\r\n        let item: any = this.content.children[listId];\r\n        let listItem: ListItem;\r\n        if (!item) { //如果不存在\r\n            item = instantiate(this._itemTmp);\r\n            item._listId = listId;\r\n            this.content.addChild(item);\r\n            listItem = item.getComponent(ListItem);\r\n            item['listItem'] = listItem;\r\n            if (listItem) {\r\n                listItem.listId = listId;\r\n                listItem.list = this;\r\n                listItem._registerEvent();\r\n            }\r\n            if (this.renderEvent) {\r\n                EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\r\n            }\r\n        } else if (this._forceUpdate && this.renderEvent) { //强制更新\r\n            item._listId = listId;\r\n            if (listItem)\r\n                listItem.listId = listId;\r\n            if (this.renderEvent) {\r\n                EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\r\n            }\r\n        }\r\n        this._updateListItem(listItem);\r\n        if (this._lastDisplayData.indexOf(listId) < 0) {\r\n            this._lastDisplayData.push(listId);\r\n        }\r\n    }\r\n\r\n    _updateListItem(listItem: ListItem) {\r\n        if (!listItem)\r\n            return;\r\n        if (this.selectedMode > SelectedType.NONE) {\r\n            let item: any = listItem.node;\r\n            switch (this.selectedMode) {\r\n                case SelectedType.SINGLE:\r\n                    listItem.selected = this.selectedId == item._listId;\r\n                    break;\r\n                case SelectedType.MULT:\r\n                    listItem.selected = this.multSelected.indexOf(item._listId) >= 0;\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    //仅虚拟列表用\r\n    _resetItemSize(item: any) {\r\n        return;\r\n        let size: number;\r\n        let ut: UITransform = item.getComponent(UITransform);\r\n        if (this._customSize && this._customSize[item._listId]) {\r\n            size = this._customSize[item._listId];\r\n        } else {\r\n            if (this._colLineNum > 1)\r\n                ut.setContentSize(this._itemSize);\r\n            else\r\n                size = this._sizeType ? this._itemSize.height : this._itemSize.width;\r\n        }\r\n        if (size) {\r\n            if (this._sizeType)\r\n                ut.height = size;\r\n            else\r\n                ut.width = size;\r\n        }\r\n    }\r\n    /**\r\n     * 更新Item位置\r\n     * @param {Number||Node} listIdOrItem\r\n     */\r\n    _updateItemPos(listIdOrItem: any) {\r\n        let item: any = isNaN(listIdOrItem) ? listIdOrItem : this.getItemByListId(listIdOrItem);\r\n        let pos: any = this.getItemPos(item._listId);\r\n        item.setPosition(pos.x, pos.y);\r\n    }\r\n    /**\r\n     * 设置多选\r\n     * @param {Array} args 可以是单个listId，也可是个listId数组\r\n     * @param {Boolean} bool 值，如果为null的话，则直接用args覆盖\r\n     */\r\n    setMultSelected(args: any, bool: boolean) {\r\n        let t: any = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (!Array.isArray(args)) {\r\n            args = [args];\r\n        }\r\n        if (bool == null) {\r\n            t.multSelected = args;\r\n        } else {\r\n            let listId: number, sub: number;\r\n            if (bool) {\r\n                for (let n: number = args.length - 1; n >= 0; n--) {\r\n                    listId = args[n];\r\n                    sub = t.multSelected.indexOf(listId);\r\n                    if (sub < 0) {\r\n                        t.multSelected.push(listId);\r\n                    }\r\n                }\r\n            } else {\r\n                for (let n: number = args.length - 1; n >= 0; n--) {\r\n                    listId = args[n];\r\n                    sub = t.multSelected.indexOf(listId);\r\n                    if (sub >= 0) {\r\n                        t.multSelected.splice(sub, 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        t._forceUpdate = true;\r\n        t._onScrolling();\r\n    }\r\n    /**\r\n     * 获取多选数据\r\n     * @returns\r\n     */\r\n    getMultSelected() {\r\n        return this.multSelected;\r\n    }\r\n    /**\r\n     * 多选是否有选择\r\n     * @param {number} listId 索引\r\n     * @returns\r\n     */\r\n    hasMultSelected(listId: number) {\r\n        return this.multSelected && this.multSelected.indexOf(listId) >= 0;\r\n    }\r\n    /**\r\n     * 更新指定的Item\r\n     * @param {Array} args 单个listId，或者数组\r\n     * @returns\r\n     */\r\n    updateItem(args: any) {\r\n        if (!this.checkInited())\r\n            return;\r\n        if (!Array.isArray(args)) {\r\n            args = [args];\r\n        }\r\n        for (let n: number = 0, len: number = args.length; n < len; n++) {\r\n            let listId: number = args[n];\r\n            let item: any = this.getItemByListId(listId);\r\n            if (item)\r\n                EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\r\n        }\r\n    }\r\n    /**\r\n     * 更新全部\r\n     */\r\n    updateAll() {\r\n        if (!this.checkInited())\r\n            return;\r\n        this.numItems = this.numItems;\r\n    }\r\n    /**\r\n     * 根据ListID获取Item\r\n     * @param {Number} listId\r\n     * @returns\r\n     */\r\n    getItemByListId(listId: number) {\r\n        if (this.content) {\r\n            for (let n: number = this.content.children.length - 1; n >= 0; n--) {\r\n                let item: any = this.content.children[n];\r\n                if (item._listId == listId)\r\n                    return item;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 获取在显示区域外的Item\r\n     * @returns\r\n     */\r\n    _getOutsideItem() {\r\n        let item: any;\r\n        let result: any[] = [];\r\n        for (let n: number = this.content.children.length - 1; n >= 0; n--) {\r\n            item = this.content.children[n];\r\n            if (!this.displayData.find(d => d.id == item._listId)) {\r\n                result.push(item);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    //删除显示区域以外的Item\r\n    _delRedundantItem() {\r\n        if (this._virtual) {\r\n            let arr: any[] = this._getOutsideItem();\r\n            for (let n: number = arr.length - 1; n >= 0; n--) {\r\n                let item: any = arr[n];\r\n                if (this._scrollItem && item._listId == this._scrollItem._listId)\r\n                    continue;\r\n                item.isCached = true;\r\n                this._pool.put(item);\r\n                for (let m: number = this._lastDisplayData.length - 1; m >= 0; m--) {\r\n                    if (this._lastDisplayData[m] == item._listId) {\r\n                        this._lastDisplayData.splice(m, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // cc.log('存入::', str, '    pool.length =', this._pool.length);\r\n        } else {\r\n            while (this.content.children.length > this._numItems) {\r\n                this._delSingleItem(this.content.children[this.content.children.length - 1]);\r\n            }\r\n        }\r\n    }\r\n    //删除单个Item\r\n    _delSingleItem(item: any) {\r\n        // cc.log('DEL::', item['_listId'], item);\r\n        item.removeFromParent();\r\n        if (item.destroy)\r\n            item.destroy();\r\n        item = null;\r\n    }\r\n    /** \r\n     * 动效删除Item（此方法只适用于虚拟列表，即_virtual=true）\r\n     * 一定要在回调函数里重新设置新的numItems进行刷新，毕竟本List是靠数据驱动的。\r\n     */\r\n    aniDelItem(listId: number, callFunc: Function, aniType: number) {\r\n        let t: any = this;\r\n\r\n        if (!t.checkInited() || t.cyclic || !t._virtual)\r\n            return console.error('This function is not allowed to be called!');\r\n\r\n        if (!callFunc)\r\n            return console.error('CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!');\r\n\r\n        if (t._aniDelRuning)\r\n            return console.warn('Please wait for the current deletion to finish!');\r\n\r\n        let item: any = t.getItemByListId(listId);\r\n        let listItem: ListItem;\r\n        if (!item) {\r\n            callFunc(listId);\r\n            return;\r\n        } else {\r\n            listItem = item.getComponent(ListItem);\r\n        }\r\n        t._aniDelRuning = true;\r\n        t._aniDelCB = callFunc;\r\n        t._aniDelItem = item;\r\n        t._aniDelBeforePos = item.position;\r\n        t._aniDelBeforeScale = item.scale;\r\n        let curLastId: number = t.displayData[t.displayData.length - 1].id;\r\n        let resetSelectedId: boolean = listItem.selected;\r\n        listItem.showAni(aniType, () => {\r\n            //判断有没有下一个，如果有的话，创建粗来\r\n            let newId: number;\r\n            if (curLastId < t._numItems - 2) {\r\n                newId = curLastId + 1;\r\n            }\r\n            if (newId != null) {\r\n                let newData: any = t._calcItemPos(newId);\r\n                t.displayData.push(newData);\r\n                if (t._virtual)\r\n                    t._createOrUpdateItem(newData);\r\n                else\r\n                    t._createOrUpdateItem2(newId);\r\n            } else\r\n                t._numItems--;\r\n            if (t.selectedMode == SelectedType.SINGLE) {\r\n                if (resetSelectedId) {\r\n                    t._selectedId = -1;\r\n                } else if (t._selectedId - 1 >= 0) {\r\n                    t._selectedId--;\r\n                }\r\n            } else if (t.selectedMode == SelectedType.MULT && t.multSelected.length) {\r\n                let sub: number = t.multSelected.indexOf(listId);\r\n                if (sub >= 0) {\r\n                    t.multSelected.splice(sub, 1);\r\n                }\r\n                //多选的数据，在其后的全部减一\r\n                for (let n: number = t.multSelected.length - 1; n >= 0; n--) {\r\n                    let id: number = t.multSelected[n];\r\n                    if (id >= listId)\r\n                        t.multSelected[n]--;\r\n                }\r\n            }\r\n            if (t._customSize) {\r\n                if (t._customSize[listId])\r\n                    delete t._customSize[listId];\r\n                let newCustomSize: any = {};\r\n                let size: number;\r\n                for (let id in t._customSize) {\r\n                    size = t._customSize[id];\r\n                    let idNumber: number = parseInt(id);\r\n                    newCustomSize[idNumber - (idNumber >= listId ? 1 : 0)] = size;\r\n                }\r\n                t._customSize = newCustomSize;\r\n            }\r\n            //后面的Item向前怼的动效\r\n            let sec: number = .2333;\r\n            let twe: Tween<Node>, haveCB: boolean;\r\n            for (let n: number = newId != null ? newId : curLastId; n >= listId + 1; n--) {\r\n                item = t.getItemByListId(n);\r\n                if (item) {\r\n                    let posData: any = t._calcItemPos(n - 1);\r\n                    twe = tween(item)\r\n                        .to(sec, { position: new Vec3(posData.x, posData.y, 0) });\r\n\r\n                    if (n <= listId + 1) {\r\n                        haveCB = true;\r\n                        twe.call(() => {\r\n                            t._aniDelRuning = false;\r\n                            callFunc(listId);\r\n                            delete t._aniDelCB;\r\n                        });\r\n                    }\r\n                    twe.start();\r\n                }\r\n            }\r\n            if (!haveCB) {\r\n                t._aniDelRuning = false;\r\n                callFunc(listId);\r\n                t._aniDelCB = null;\r\n            }\r\n        }, true);\r\n    }\r\n    /**\r\n     * 滚动到..\r\n     * @param {Number} listId 索引（如果<0，则滚到首个Item位置，如果>=_numItems，则滚到最末Item位置）\r\n     * @param {Number} timeInSecond 时间\r\n     * @param {Number} offset 索引目标位置偏移，0-1\r\n     * @param {Boolean} overStress 滚动后是否强调该Item（这只是个实验功能）\r\n     */\r\n    scrollTo(listId: number, timeInSecond: number = .5, offset: number = null, overStress: boolean = false) {\r\n        let t = this;\r\n        if (!t.checkInited(false))\r\n            return;\r\n        // t._scrollView.stopAutoScroll();\r\n        if (timeInSecond == null)   //默认0.5\r\n            timeInSecond = .5;\r\n        else if (timeInSecond < 0)\r\n            timeInSecond = 0;\r\n        if (listId < 0)\r\n            listId = 0;\r\n        else if (listId >= t._numItems)\r\n            listId = t._numItems - 1;\r\n        // 以防设置了numItems之后layout的尺寸还未更新\r\n        if (!t._virtual && t._layout && t._layout.enabled)\r\n            t._layout.updateLayout();\r\n\r\n        let pos = t.getItemPos(listId);\r\n        if (!pos) {\r\n            return DEV && console.error('pos is null', listId);\r\n        }\r\n        let targetX: number, targetY: number;\r\n\r\n        switch (t._alignCalcType) {\r\n            case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                targetX = pos.left;\r\n                if (offset != null)\r\n                    targetX -= t._thisNodeUt.width * offset;\r\n                else\r\n                    targetX -= t._leftGap;\r\n                pos = new Vec3(targetX, 0, 0);\r\n                break;\r\n            case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                targetX = pos.right - t._thisNodeUt.width;\r\n                if (offset != null)\r\n                    targetX += t._thisNodeUt.width * offset;\r\n                else\r\n                    targetX += t._rightGap;\r\n                pos = new Vec3(targetX + t._contentUt.width, 0, 0);\r\n                break;\r\n            case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                targetY = pos.top;\r\n                if (offset != null)\r\n                    targetY += t._thisNodeUt.height * offset;\r\n                else\r\n                    targetY += t._topGap;\r\n                pos = new Vec3(0, -targetY, 0);\r\n                break;\r\n            case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                targetY = pos.bottom + t._thisNodeUt.height;\r\n                if (offset != null)\r\n                    targetY -= t._thisNodeUt.height * offset;\r\n                else\r\n                    targetY -= t._bottomGap;\r\n                pos = new Vec3(0, -targetY + t._contentUt.height, 0);\r\n                break;\r\n        }\r\n        let viewPos: any = t.content.getPosition();\r\n        viewPos = Math.abs(t._sizeType ? viewPos.y : viewPos.x);\r\n\r\n        let comparePos = t._sizeType ? pos.y : pos.x;\r\n        let runScroll = Math.abs((t._scrollPos != null ? t._scrollPos : viewPos) - comparePos) > .5;\r\n        // cc.log(runScroll, t._scrollPos, viewPos, comparePos)\r\n\r\n        // t._scrollView.stopAutoScroll();\r\n        if (runScroll) {\r\n            t._scrollView.scrollToOffset(pos, timeInSecond);\r\n            t._scrollToListId = listId;\r\n            t._scrollToEndTime = ((new Date()).getTime() / 1000) + timeInSecond;\r\n            // cc.log(listId, t.content.width, t.content.getPosition(), pos);\r\n            t._scrollToSo = t.scheduleOnce(() => {\r\n                if (!t._adheringBarrier) {\r\n                    t.adhering = t._adheringBarrier = false;\r\n                }\r\n                t._scrollPos =\r\n                    t._scrollToListId =\r\n                    t._scrollToEndTime =\r\n                    t._scrollToSo =\r\n                    null;\r\n                //cc.log('2222222222', t._adheringBarrier)\r\n                if (overStress) {\r\n                    // t.scrollToListId = listId;\r\n                    let item = t.getItemByListId(listId);\r\n                    if (item) {\r\n                        tween(item)\r\n                            .to(.1, { scale: 1.05 })\r\n                            .to(.1, { scale: 1 })\r\n                            .start();\r\n                    }\r\n                }\r\n            }, timeInSecond + .1);\r\n\r\n            if (timeInSecond <= 0) {\r\n                t._onScrolling();\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 计算当前滚动窗最近的Item\r\n     */\r\n    _calcNearestItem() {\r\n        let t: any = this;\r\n        t.nearestListId = null;\r\n        let data: any, center: number;\r\n\r\n        if (t._virtual)\r\n            t._calcViewPos();\r\n\r\n        let vTop: number, vRight: number, vBottom: number, vLeft: number;\r\n        vTop = t.viewTop;\r\n        vRight = t.viewRight;\r\n        vBottom = t.viewBottom;\r\n        vLeft = t.viewLeft;\r\n\r\n        let breakFor: boolean = false;\r\n        for (let n = 0; n < t.content.children.length && !breakFor; n += t._colLineNum) {\r\n            data = t._virtual ? t.displayData[n] : t._calcExistItemPos(n);\r\n            if (data) {\r\n                center = t._sizeType ? ((data.top + data.bottom) / 2) : (center = (data.left + data.right) / 2);\r\n                switch (t._alignCalcType) {\r\n                    case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                        if (data.right >= vLeft) {\r\n                            t.nearestListId = data.id;\r\n                            if (vLeft > center)\r\n                                t.nearestListId += t._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                    case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                        if (data.left <= vRight) {\r\n                            t.nearestListId = data.id;\r\n                            if (vRight < center)\r\n                                t.nearestListId += t._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                    case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                        if (data.bottom <= vTop) {\r\n                            t.nearestListId = data.id;\r\n                            if (vTop < center)\r\n                                t.nearestListId += t._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                    case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                        if (data.top >= vBottom) {\r\n                            t.nearestListId = data.id;\r\n                            if (vBottom > center)\r\n                                t.nearestListId += t._colLineNum;\r\n                            breakFor = true;\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        //判断最后一个Item。。。（哎，这些判断真心恶心，判断了前面的还要判断最后一个。。。一开始呢，就只有一个布局（单列布局），那时候代码才三百行，后来就想着完善啊，艹..这坑真深，现在这行数都一千五了= =||）\r\n        data = t._virtual ? t.displayData[t.displayItemNum - 1] : t._calcExistItemPos(t._numItems - 1);\r\n        if (data && data.id == t._numItems - 1) {\r\n            center = t._sizeType ? ((data.top + data.bottom) / 2) : (center = (data.left + data.right) / 2);\r\n            switch (t._alignCalcType) {\r\n                case 1://单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\r\n                    if (vRight > center)\r\n                        t.nearestListId = data.id;\r\n                    break;\r\n                case 2://单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\r\n                    if (vLeft < center)\r\n                        t.nearestListId = data.id;\r\n                    break;\r\n                case 3://单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\r\n                    if (vBottom < center)\r\n                        t.nearestListId = data.id;\r\n                    break;\r\n                case 4://单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\r\n                    if (vTop > center)\r\n                        t.nearestListId = data.id;\r\n                    break;\r\n            }\r\n        }\r\n        // cc.log('t.nearestListId =', t.nearestListId);\r\n    }\r\n    //上一页\r\n    prePage(timeInSecond: number = .5) {\r\n        // cc.log('👈');\r\n        if (!this.checkInited())\r\n            return;\r\n        this.skipPage(this.curPageNum - 1, timeInSecond);\r\n    }\r\n    //下一页\r\n    nextPage(timeInSecond: number = .5) {\r\n        // cc.log('👉');\r\n        if (!this.checkInited())\r\n            return;\r\n        this.skipPage(this.curPageNum + 1, timeInSecond);\r\n    }\r\n    //跳转到第几页\r\n    skipPage(pageNum: number, timeInSecond: number) {\r\n        let t: any = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (t._slideMode != SlideType.PAGE)\r\n            return console.error('This function is not allowed to be called, Must SlideMode = PAGE!');\r\n        if (pageNum < 0 || pageNum >= t._numItems)\r\n            return;\r\n        if (t.curPageNum == pageNum)\r\n            return;\r\n        // cc.log(pageNum);\r\n        t.curPageNum = pageNum;\r\n        if (t.pageChangeEvent) {\r\n            EventHandler.emitEvents([t.pageChangeEvent], pageNum);\r\n        }\r\n        t.scrollTo(pageNum, timeInSecond);\r\n    }\r\n    //计算 CustomSize（这个函数还是保留吧，某些罕见的情况的确还是需要手动计算customSize的）\r\n    calcCustomSize(numItems: number) {\r\n        let t: any = this;\r\n        if (!t.checkInited())\r\n            return;\r\n        if (!t._itemTmp)\r\n            return console.error('Unset template item!');\r\n        if (!t.renderEvent)\r\n            return console.error('Unset Render-Event!');\r\n        t._customSize = {};\r\n        let temp: any = instantiate(t._itemTmp);\r\n        let ut: UITransform = temp.getComponent(UITransform);\r\n        t.content.addChild(temp);\r\n        for (let n: number = 0; n < numItems; n++) {\r\n            EventHandler.emitEvents([t.renderEvent], temp, n);\r\n            if (ut.height != t._itemSize.height || ut.width != t._itemSize.width) {\r\n                t._customSize[n] = t._sizeType ? ut.height : ut.width;\r\n            }\r\n        }\r\n        if (!Object.keys(t._customSize).length)\r\n            t._customSize = null;\r\n        temp.removeFromParent();\r\n        if (temp.destroy)\r\n            temp.destroy();\r\n        return t._customSize;\r\n    }\r\n}\r\n"]}